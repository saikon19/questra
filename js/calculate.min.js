function account_to_packages(e){for(var a=[],t=0,s=prices.length-1;s>=0;s--)t=Math.floor(e/prices[s]),e-=prices[s]*t,a.push(t);return{numOfPackageArr:a.reverse(),account:e}}function getDateFormated(e){var a=e.getDate()<10?"0"+e.getDate():e.getDate(),t=e.getMonth()+1;return a+"/"+(t=10>t?"0"+t:t)+"/"+e.getFullYear()}function Get(e){var a=new XMLHttpRequest;return a.open("GET",e,!1),a.send(null),a.responseText}function currencyConverter(e,a){return e*a}function printDiv(e){var a=document.getElementById(e).innerHTML,t=document.body.innerHTML;document.body.innerHTML=a,window.print(),document.body.innerHTML=t}var packages=["white","yellow","green","blue","red","black","indigo"],prices=[90,270,810,2430,7290,21870,65610],commission=[.39,.36,.3,.24,.21,.1,.07],insurance=.1,revenue=0,profits=[],Json_Obj;try{Json_Obj=JSON.parse(Get("https://api.fixer.io/latest"))}catch(e){Json_Obj=JSON.parse('{"base":"EUR","date":"2017-09-05","rates":{"AUD":1.4902,"BGN":1.9558,"BRL":3.707,"CAD":1.4732,"CHF":1.1407,"CNY":7.7865,"CZK":26.077,"DKK":7.4381,"GBP":0.9174,"HKD":9.3043,"HRK":7.4173,"HUF":306.39,"IDR":15854.0,"ILS":4.2425,"INR":76.248,"JPY":129.99,"KRW":1343.6,"MXN":21.218,"MYR":5.0668,"NOK":9.2788,"NZD":1.6531,"PHP":60.804,"PLN":4.2361,"RON":4.5965,"RUB":68.914,"SEK":9.469,"SGD":1.6115,"THB":39.451,"TRY":4.0954,"USD":1.189,"ZAR":15.39}}')}var Json_Sym=JSON.parse('{"symbol":{"AUD":"&#36;","BGN":"‎лв","BRL":"‎R$","CAD":"C$","CHF":"&curren;","CNY":"&#165;","CZK":"Kč","DKK":"‎kr","GBP":"&pound;","HKD":"&dollar;","HRK":"kn","HUF":"‎Ft","IDR":"‎Rp","ILS":"₪","INR":"&#8377;","JPY":"&#165;","KRW":"&#8361;","MXN":"&dollar;","MYR":"RM","NOK":"kr","NZD":"&dollar;","PHP":"&#x20B1;","PLN":"zł","RON":"&curren;","RUB":"‎₽","SEK":"kr","SGD":"&dollar;","THB":"‎฿","TRY":"₺","USD":"&dollar;","ZAR":"R"}}');$(document).ready(function(){function e(e,a){var t=e*$("#startInvest").val();$("#currency_label").html(a+"&nbsp;"+s(Math.round(t)));for(var n=0;n<l.length;n++)$("#"+l[n]).html(a+"&nbsp;"+s(Math.round(currencyConverter(e,prices[n]))));$("#con_rates").html(a+"&nbsp;"),$("#cur_rate").val(e)}function a(e,a){var t=e*$("#startInvest").val();$("#currency_label").html(a+"&nbsp;"+s(Math.round(t)))}function t(e){console.log(e);for(var a=0;a<Object.keys(Json_Sym.symbol).length;a++)if(Object.keys(Json_Sym.symbol)[a]==e)return Object.values(Json_Sym.symbol)[a]}function s(e){return"&#8377;"==d?e.toLocaleString("en-IN"):e.toLocaleString("en-US")}var n=document.getElementById("sc");for(i=0;i<Object.keys(Json_Obj.rates).length;i++){var r=document.createElement("option");r.text=Object.keys(Json_Obj.rates)[i],r.value=Object.values(Json_Obj.rates)[i];try{n.options.add(r)}catch(e){alert(e)}}revenue=$("#pro_id").val()/100,$("#pro_id").on("input",function(){revenue=$("#pro_id").val()/100});var l=["whitelbl","yellowlbl","greenlbl","bluelbl","redlbl","blacklbl","indigolbl"],o=Object.values(Json_Obj.rates)[14],d="&#8377;";document.getElementById("sc").addEventListener("change",function(){o=this.value,d=t(this.options[this.selectedIndex].text),e(o,d)},!1),$("#cur_rate").on("input",function(){e(o=$(this).val(),d)});$("#startInvest").on("input",function(){a(o,d)}),e(o,d),a(o,d),$('[data-toggle="popover"]').popover(),$(".questra-checkbox").click(function(){$("#table_result").hasClass("hide")||$("#calculate_button").trigger("click")}),$("#instruction").click(function(){var e=$("#formula");e.hasClass("hide")?(e.removeClass("hide"),$("#instruction label").html("Hide formula")):(e.addClass("hide"),$("#instruction label").html("Show formula"))}),$("#table_view").click(function(){1==$(this).prop("checked")?($("#table_fullview").removeClass("hide"),$("#print_week").removeClass("disabled")):0==$(this).prop("checked")&&($("#table_fullview").addClass("hide"),$("#print_week").addClass("disabled"))}),$("#table_year").click(function(){1==$(this).prop("checked")?($("#summary_table").removeClass("hide"),$("#print_year").removeClass("disabled")):0==$(this).prop("checked")&&($("#summary_table").addClass("hide"),$("#print_year").addClass("disabled"))}),$("input").focus(function(){$(this).select()}),$(".package").on("input",function(){$("startInvest").attr("readonly","true"),$("#remain").hasClass("hide")||$("#remain").addClass("hide");for(var e=0,a=0;a<packages.length;a++)e+=parseInt(""==$("#num-of-"+packages[a]+"-package").val()?0:$("#num-of-"+packages[a]+"-package").val())*prices[a];$("#startInvest").val(e)}),$("#startInvest").on("input",function(){$(".package").attr("readonly","true");var e=parseInt(""==$(this).val()?0:$(this).val()),a=account_to_packages(e),t=a.numOfPackageArr;e=a.account;for(var s=0;s<packages.length;s++)$("#num-of-"+packages[s]+"-package").val(t[s]);e>0?($("#remain_number").html(e),$("#remain").removeClass("hide")):$("#remain").addClass("hide")}),$("#redo_button").on("click",function(e){$("#startInvest").removeAttr("readonly").val(0),$(".package").removeAttr("readonly").val(0),$("#remain").hasClass("hide")||$("#remain").addClass("hide"),$("#weeklyWithdrawAmount").val(0),$("#fromWeek").val(0),$("#toWeek").val(0),$("#summary_table").addClass("hide"),$("#table_fullview").addClass("hide"),$("#print_buttons").addClass("hide"),$("#summary").addClass("hide")}),$("input[name='questra-invest-plan']").change(function(e){"questra-invest-manual-plan"==$(this).attr("id")?$("#questra-manual-plan").removeClass("disabled"):($("#questra-manual-plan").addClass("disabled"),$("#weeklyWithdrawAmount").val(0)),$("#calculate_button").trigger("click")}),$("#calculate_button").on("click",function(e){$("#print_buttons").removeClass("hide");var a=new Date;a.setDate(a.getDate()+(8-a.getDay())%7+4);var t=0,n=parseInt(""==$("#startInvest").val()?0:$("#startInvest").val()),r=n,l=[];if($("#questra-insurance").is(":checked")){profits=[];for(g=0;g<packages.length;g++){i=Math.round(prices[g]*revenue*(1-insurance-commission[g])*100)/100;profits.push(i)}}else{profits=[];for(g=0;g<packages.length;g++){var i=Math.round(prices[g]*revenue*(1-commission[g])*100)/100;profits.push(i)}}var u=0,c=parseInt(""==$("#weeklyWithdrawAmount").val()?0:$("#weeklyWithdrawAmount").val()),p=c,m=parseInt(""==$("#fromWeek").val()?0:$("#fromWeek").val()),h=parseInt(""==$("#toWeek").val()?0:$("#toWeek").val()),v=0;$("#table_result").hasClass("hide")&&$("#table_result").removeClass("hide");var b=$("#table_result tbody"),_=$("#Summary_table_result tbody");b.html(""),_.html("");for(var k="",g=0;g<packages.length;g++)k+="<th><img src='images/"+packages[g]+"-package.png' class='img-rounded' width='30' height='30'></th>";$("#questra-packagesColumn").replaceWith(k);for(var f=$("input[name=questra-invest-plan]:checked").attr("id"),y=parseInt(""==$("#num-of-week").val()?0:$("#num-of-week").val()),C=1;C<=y;C++){for(g=0;g<l.length;g++)r+=l[g]*prices[g];var w=account_to_packages(r+=t);l=w.numOfPackageArr,r=w.account,t=0,u=0;var I="";I="<tr><td>"+C+"</td><td>"+getDateFormated(a)+"</td>";for(g=0;g<packages.length;g++)I+="<td id='"+packages[g]+"_"+C+"' class='"+packages[g]+"'>"+l[g],t+=profits[g]*l[g],u+=l[g]*prices[g];I+="<td id='week_profit_"+C+"'></td>",I+="<td id='account_"+C+"'></td>",I+="<td id='money_invested_"+C+"'></td>",I+="<td id='withdraw_amount_"+C+"'></td>",I+="</tr>",b.append(I);var D="",M=C/52;switch(M%1==0&&(D="<tr><td>"+C+"</td><td>"+getDateFormated(a)+"</td><td id='week_profit_s"+C+"'></td><td id='account_s"+C+"'></td><td id='money_invested_s"+C+"'></td><td id='withdraw_amount_s"+C+"'></td></tr>",_.append(D)),f){case"questra-invest-manual-plan":p=c,C>=m&&C<=h&&p>0?(p>=t+r?(p=t+r,t=0,r=0):p>t?(r-=p-t,t=0):t-=p,v+=p):p=0;break;case"questra-invest-plan-A":p=0;break;case"questra-invest-plan-B":m=1,p=t+r,t=0,r=0,(v+=p)>=n&&(h=C,t=v-n,v=n,p-=t,f="questra-invest-plan-A");break;case"questra-invest-plan-C":m=1,h=C,t-=p=t/2,v+=p;break;case"questra-invest-plan-D":C<=y/2?(m=C+1,p=0):(h=C,p=t+r,t=0,r=0,v+=p)}t=Math.round(100*t)/100,$("#week_profit_"+C).html("<span>&euro;&nbsp;"+s(t)+"</span>"),r=Math.round(100*r)/100,$("#account_"+C).html("<span>&euro;&nbsp;"+s(r)+"</span>"),$("#money_invested_"+C).html("<span>&euro;&nbsp;"+s(u)+"</span>"),p=Math.round(100*p)/100,$("#withdraw_amount_"+C).html("<span>&euro;&nbsp;"+s(p)+"</span>"),M%1==0&&($("#week_profit_s"+C).html("<span>&euro;&nbsp;"+s(t)+"</span><span>&nbsp;("+d+"&nbsp;"+s(Math.round(o*t))+")</span>"),$("#account_s"+C).html("<span>&euro;&nbsp;"+s(r)+"</span><span>&nbsp;("+d+"&nbsp;"+s(Math.round(o*r))+")</span>"),$("#money_invested_s"+C).html("<span>&euro;&nbsp;"+s(u)+"</span><span>&nbsp;("+d+"&nbsp;"+s(Math.round(o*u))+")</span>"),$("#withdraw_amount_s"+C).html("<span>&euro;&nbsp;"+s(p)+"</span><span>&nbsp;("+d+"&nbsp;"+s(Math.round(o*p))+")</span>")),a.setDate(a.getDate()+7)}v=Math.round(100*v)/100;$("#summary");$("#summary_startInvest").html("&euro;&nbsp;"+s($("#startInvest").val())+"&nbsp;("+d+"&nbsp;"+s(Math.round(o*$("#startInvest").val()))+")"),$("#summary_numOfWeek").html(y),$("#summary_moneyInvested").html("&euro;&nbsp;"+s(u)+"&nbsp;("+d+"&nbsp;"+s(Math.round(o*u))+")");for(var O="",g=0;g<l.length;g++)l[g]>0&&(O+=" "+l[g]+" <img src='images/"+packages[g]+"-package.png' class='img-rounded' width='30' height='30'> ");O=O.slice(0,-1),$("#summary_numOfActivePackages").html(O),$("#summary_nextWeek").html(y+1);var R=t+p;R=Math.round(100*R)/100,$("#summary_income").html("&euro;&nbsp;"+s(R)+"&nbsp;("+d+"&nbsp;"+s(Math.round(o*R))+")"),v>0?($("#summary_withdraw").removeClass("hide"),$("#summary_totalWithdraw").html("&euro;&nbsp;"+s(v)+"&nbsp;("+d+"&nbsp;"+s(Math.round(o*v))+")"),$("#summary_fromWeek").html(m),$("#summary_toWeek").html(h)):$("#summary_withdraw").addClass("hide"),$("#summary_row").removeClass("hide"),$("#summary").removeClass("hide"),1==$("#table_view").prop("checked")?$("#table_fullview").removeClass("hide"):0==$("#table_view").prop("checked")&&$("#table_fullview").addClass("hide"),1==$("#table_year").prop("checked")?$("#summary_table").removeClass("hide"):0==$("#table_year").prop("checked")&&$("#summary_table").addClass("hide")}),$("#summary_table").addClass("hide"),$("#table_fullview").addClass("hide"),$("#summary").addClass("hide"),$("#print_buttons").addClass("hide")});